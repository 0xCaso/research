\section{Complexity results for maximin support}\label{s:complexity}

Consider an instance $(G=(N\cup C, E), s, k)$ of a multiwinner election as defined in Section~\ref{s:prel}. 
In this section, we present a complete analysis of the complexity of the maximin support problem, including new results both on approximability and on hardness, and conclude the section with an optimized $2$-factor approximation algorithm. As our ultimate goal is to develop algorithms that provide guarantees for both the PJR property and the maximin support objective, we also analyze how the relevant heuristics in the literature of the former fare for the latter. 

The maximin support problem was introduced in~\cite{sanchez2016maximin}, where it was observed to be NP-hard. We start by showing a stronger hardness result for this problem, which rules out the existence of a PTAS.

\begin{figure}[htb]
\begin{center}
\scalebox{.7}{

\definecolor{ffqqqq}{rgb}{1,0,0}
\definecolor{ududff}{rgb}{0.30196078431372547,0.30196078431372547,1}
\begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=1cm,y=1cm]
\clip(0.5,0.5) rectangle (17.5,7.5);
\draw [line width=1pt] (1,4)-- (4,6);
\draw [line width=1pt] (4,6)-- (7,4);
\draw [line width=1pt] (7,4)-- (6,1);
\draw [line width=1pt] (6,1)-- (2,1);
\draw [line width=1pt] (2,1)-- (1,4);
\draw [line width=1pt] (1,4)-- (2.4,3);
\draw [line width=1pt] (2.4,3)-- (2,1);
\draw [line width=1pt] (2.4,3)-- (4,4);
\draw [line width=1pt] (4,4)-- (5.6,3);
\draw [line width=1pt] (5.6,3)-- (6,1);
\draw [line width=1pt] (7,4)-- (5.6,3);
\draw [line width=1pt] (4,6)-- (4,4);
\draw [->,line width=1pt] (8,3) -- (10,3);
\draw [line width=1pt] (14,6)-- (11,4);
\draw [line width=1pt] (11,4)-- (12,1);
\draw [line width=1pt] (12,1)-- (16,1);
\draw [line width=1pt] (16,1)-- (17,4);
\draw [line width=1pt] (17,4)-- (15.6,3);
\draw [line width=1pt] (15.6,3)-- (16,1);
\draw [line width=1pt] (12,1)-- (12.4,3);
\draw [line width=1pt] (12.4,3)-- (14,4);
\draw [line width=1pt] (14,4)-- (15.6,3);
\draw [line width=1pt] (11,4)-- (12.4,3);
\draw [line width=1pt] (14,6)-- (14,4);
\draw [line width=1pt] (14,6)-- (17,4);
\draw (3,7) node[anchor=north west] {$G'=(V',E')$};
\draw (13,7) node[anchor=north west] {$G=(N \cup C,E)$};
\begin{scriptsize}
\draw [fill=ududff] (11,4) circle (2.5pt);
\draw [fill=ududff] (14,4) circle (2.5pt);
\draw [fill=ududff] (14,6) circle (2.5pt);
\draw [fill=ududff] (17,4) circle (2.5pt);
\draw [fill=ududff] (16,1) circle (2.5pt);
\draw [fill=ududff] (12,1) circle (2.5pt);
\draw [fill=ududff] (12.4,3) circle (2.5pt);
\draw [fill=ududff] (15.6,3) circle (2.5pt);
\draw [fill=ffqqqq,shift={(12.5,5)}] (0,0) ++(0 pt,3pt) -- ++(2.598pt,-4.5pt)--++(-5.196pt,0 pt) -- ++(2.598pt,4.5pt);
\draw [fill=ffqqqq,shift={(15.5,5)}] (0,0) ++(0 pt,3pt) -- ++(2.598pt,-4.5pt)--++(-5.196pt,0 pt) -- ++(2.598pt,4.5pt);
\draw [fill=ffqqqq,shift={(14,5)}] (0,0) ++(0 pt,3pt) -- ++(2.598pt,-4.5pt)--++(-5.196pt,0 pt) -- ++(2.598pt,4.5pt);
\draw [fill=ffqqqq,shift={(13.2,3.5)}] (0,0) ++(0 pt,3pt) -- ++(2.598pt,-4.5pt)--++(-5.196pt,0 pt) -- ++(2.598pt,4.5pt);
\draw [fill=ffqqqq,shift={(11.7,3.5)}] (0,0) ++(0 pt,3pt) -- ++(2.598pt,-4.5pt)--++(-5.196pt,0 pt) -- ++(2.598pt,4.5pt);
\draw [fill=ffqqqq,shift={(11.5,2.5)}] (0,0) ++(0 pt,3pt) -- ++(2.598pt,-4.5pt)--++(-5.196pt,0 pt) -- ++(2.598pt,4.5pt);
\draw [fill=ffqqqq,shift={(12.2,2)}] (0,0) ++(0 pt,3pt) -- ++(2.598pt,-4.5pt)--++(-5.196pt,0 pt) -- ++(2.598pt,4.5pt);
\draw [fill=ffqqqq,shift={(14,1)}] (0,0) ++(0 pt,3pt) -- ++(2.598pt,-4.5pt)--++(-5.196pt,0 pt) -- ++(2.598pt,4.5pt);
\draw [fill=ffqqqq,shift={(15.8,2)}] (0,0) ++(0 pt,3pt) -- ++(2.598pt,-4.5pt)--++(-5.196pt,0 pt) -- ++(2.598pt,4.5pt);
\draw [fill=ffqqqq,shift={(14.8,3.5)}] (0,0) ++(0 pt,3pt) -- ++(2.598pt,-4.5pt)--++(-5.196pt,0 pt) -- ++(2.598pt,4.5pt);
\draw [fill=ffqqqq,shift={(16.3,3.5)}] (0,0) ++(0 pt,3pt) -- ++(2.598pt,-4.5pt)--++(-5.196pt,0 pt) -- ++(2.598pt,4.5pt);
\draw [fill=ffqqqq,shift={(16.5,2.5)}] (0,0) ++(0 pt,3pt) -- ++(2.598pt,-4.5pt)--++(-5.196pt,0 pt) -- ++(2.598pt,4.5pt);
\end{scriptsize}
\end{tikzpicture}

}
\end{center}
\caption{Reduction of an instance of the the $k$-independent set problem on cubic graphs to an instance of the maximin support problem. Set $N$ of voters is represented by triangles and set $C$ of candidates by circles.}
\label{fig:hardness}
\end{figure}

\begin{lemma}\label{lem:hardness}
For any constant $\eps>0$, it is NP-hard to approximate the unweighted maximin support problem within a factor of $\alpha=1.2-\eps$.
\end{lemma}

\begin{proof}
We present a reduction from the $k$-independent set problem on cubic graphs, which is known to be NP-hard~\cite{johnson1979computers}. In this problem, one is given a graph $G'=(V',E')$ where every vertex has degree exactly 3, and a parameter $k'$, and one must decide whether there is a vertex subset $I\subseteq V'$ of size $k'$ such that no two vertices in $I$ are adjacent, i.e.~$I$ is an independent set. 
Given such an instance, we define an instance $(G=(N\cup C, E), s, k)$ of maximin support where $k=k'$, $C=V'$ (each vertex in $V'$ corresponds to a candidate), and $N=E'$ with $s_n=1$ and $C_n=n$ for each $n\in N$ (each edge in $E'$ corresponds to a voter with unit vote that approves of the two candidates on its endpoints); see Figure~\ref{fig:hardness}.
Notice that in this instance, each candidate is approved by exactly 3 voters, and two candidates $c, c'$ have an approving voter in common if and only if $c$ and $c'$ are adjacent in $V'$.

Hence, if there is an independent set $I$ of size $k$ in $G'$, the same committee of validators in $G$ can be assigned the full vote of each of its three approving voters, so that each receives a support of 3 units, which is clearly maximal. On the other hand, if there is no independent set of size $k$ in $G'$, then for any solution $(A,w)$ of the maximin support instance there must be two committee members $c,c'\in A$ who have an approving voter in common. These two members have at most five voters approving either of them, so one of them must have a support of at most $5/2$. This shows that $supp_w(A)\leq 5/2$ for any feasible solution $(A,w)$. Finally, notice that the ratio between the objective values $3$ and $5/2$ is $6/5=1.2>\alpha$, so the assumed $\alpha$-approximation algorithm for maximin support would allow us to distinguish between these two cases and decide whether such an independent set $I$ exists. This completes the proof.
\end{proof}

Recall that prior to the present work, there were only two polynomial-time algorithms known to achieve the PJR property, namely $\phragmen$~\cite{brill2017phragmen} and $\MMS$~\cite{sanchez2016maximin}. 
We analyze the performance of these two algorithms relative to the maximin support objective. 
We first prove that $\phragmen$ (Algorithm~\ref{alg:phragmen}), albeit being fast with a running time of $O(|E|\cdot k)$, does not offer a constant-factor approximation. 

\begin{algorithm}[htb]\label{alg:phragmen}
\SetAlgoLined
\KwData{Bipartite approval graph $G=(N\cup C, E)$, vector $s$ of vote strengths, target committee size $k$.}
Initialize $A=\emptyset$, $w=0\in \R^E$, $load(n)=0$ for each $n\in N$, and $load(c)=0$ for each $c\in C$\;
\For{$i=1,2,\cdots k$}{
\For{each candidate $c\in C\setminus A$}{
Update $load(c) \leftarrow \frac{1+\sum_{n\in N_c} s_n\cdot load(n)}{\sum_{n\in N_c} s_n}$\;
}
Find $c_{\min}\in \arg\min_{c\in C\setminus A} load(c)$\;
Update $A\leftarrow A+c_{\min}$\;
\For{each voter $n\in N_{c_{\min}}$}{
Update $w_{nc_{\min}} \leftarrow load(c_{\min}) - load(n)$\;
Update $load(n)\leftarrow load(c_{\min})$\;
}
}
\emph{Scaling edge weights:} for each $nc\in E$ with $w_{nc}>0$, update $w_{nc}\leftarrow w_{nc}\cdot \frac{s_n}{load(n)}$\; 
\Return $(A,w)$\;
\caption{$\phragmen$, proposed in~\cite{brill2017phragmen}}
\end{algorithm}

We remark that the method proposed in~\cite{brill2017phragmen} only considers unit votes, and outputs only a committee. 
In Algorithm~\ref{alg:phragmen} we present a natural generalization that admits weighted votes in the input, and outputs a feasible edge weight vector along with the committee, for ease of comparison with other algorithms in this paper. 
We remark however that the numerical example presented in Lemma~\ref{lem:phragmen} can be easily converted into another with unit votes -- where each voter $n$ is replaced with a cluster of voters with unit vote strength where the cluster size is proportional to $s_n$ -- that would lead to the same negative result for the method in~\cite{brill2017phragmen}, 
even when the output committee is coupled with a balanced weight vector.
\begin{figure}[htb]
\begin{center}
\scalebox{.8}{

\definecolor{rvwvcq}{rgb}{0.08235294117647059,0.396078431372549,0.7529411764705882}
\begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=1cm,y=1cm]
\clip(-1,1.5) rectangle (7,7);
\draw [-,line width=1pt] (2,6) -- (6,6);
\draw [-,line width=1pt] (2,5) -- (6,5);
\draw [-,line width=1pt] (2,4) -- (6,5);
\draw [-,line width=1pt] (2,3) -- (6,5);
\draw [-,line width=1pt] (2,2) -- (6,5);
\draw [-,line width=1pt] (2,4) -- (6,4);
\draw [-,line width=1pt] (2,3) -- (6,4);
\draw [-,line width=1pt] (2,2) -- (6,4);
\draw [-,line width=1pt] (2,3) -- (6,3);
\draw [-,line width=1pt] (2,2) -- (6,3);
\draw [-,line width=1pt] (2,2) -- (6,2);
\draw (-0.5,6.3) node[anchor=north west] {$s_0=\sfrac{1}{(H_4 - \varepsilon)}$};
\draw (-0.5,5.3) node[anchor=north west] {$s_1=1$};
\draw (-0.5,4.3) node[anchor=north west] {$s_2=1$};
\draw (-0.5,3.3) node[anchor=north west] {$s_3=1$};
\draw (-0.5,2.3) node[anchor=north west] {$s_4=1$};
\begin{scriptsize}
\draw [fill=rvwvcq] (2,6) circle (2.5pt);
\draw[color=rvwvcq] (2,6.3) node {$n_0$};
\draw [fill=rvwvcq] (2,5) circle (2.5pt);
\draw[color=rvwvcq] (2,5.3) node {$n_1$};
\draw [fill=rvwvcq] (2,4) circle (2.5pt);
\draw[color=rvwvcq] (2,4.3) node {$n_2$};
\draw [fill=rvwvcq] (2,3) circle (2.5pt);
\draw[color=rvwvcq] (2,3.3) node {$n_3$};
\draw [fill=rvwvcq] (2,2) circle (2.5pt);
\draw[color=rvwvcq] (2,2.3) node {$n_4$};
\draw [fill=rvwvcq] (6,6) circle (2.5pt);
\draw[color=rvwvcq] (6,6.3) node {$c_0$};
\draw [fill=rvwvcq] (6,5) circle (2.5pt);
\draw[color=rvwvcq] (6,5.3) node {$c_1$};
\draw [fill=rvwvcq] (6,4) circle (2.5pt);
\draw[color=rvwvcq] (6,4.3) node {$c_2$};
\draw [fill=rvwvcq] (6,3) circle (2.5pt);
\draw[color=rvwvcq] (6,3.3) node {$c_3$};
\draw [fill=rvwvcq] (6,2) circle (2.5pt);
\draw[color=rvwvcq] (6,2.3) node {$c_4$};
\end{scriptsize}
\end{tikzpicture}
}
\end{center}
\caption{Instance of maximin support where $\phragmen$ gives an approximation ratio of $H_k - \eps$, for $k=4$.}
\label{fig:phragmen}
\end{figure}

\begin{lemma}\label{lem:phragmen}
For the maximin support problem, the approximation ratio offered by $\phragmen$ (Algorithm~\ref{alg:phragmen}) is no better than the $k$-th harmonic number $H_k:=\sum_{i=1}^k 1/i = \Theta(\log k)$.
\end{lemma}

\begin{proof}
For an arbitrarily small constant $\eps>0$ and a committee size $k$, consider an instance where $N=\{n_0, \cdots, n_k\}$, $C=\{c_0, \cdots, c_k\}$, $s_{n_j}=1$ and $C_{n_j}=\{c_i: \ 1\leq i\leq j\}$ for each $1\leq j\leq k$, and $s_0=1/(H_k - \eps)$ with $C_{n_0}=\{c_0\}$; see Figure~\ref{fig:phragmen}. 
It is easy to see that if committee $\{c_1, \cdots, c_k\}$ is selected, each member can be given a support of value $1$. On the other hand, any committee that selects candidate $c_{0}$ can only provide it a support of value $s_0$. We will prove that Algorithm~\ref{alg:phragmen} selects committee $\{c_0, c_1, \cdots, c_{k-1}\}$, and thus its approximation ratio is $1/s_0 = H_k - \eps$. 

In the first round, we have that $load(c_0)=1/s_0$ and $load(c_j)=\frac{1}{k+1-j}$ for each $j\geq 1$, so we add $c_1$ to the committee, which has $load(c_1)=1/k = H_k - H_{k-1}$, and update $load(n_j)\leftarrow H_k - H_{k-1}$ for each $j\geq 1$. 
More generally, in the $i$-th round for $1\leq i\leq k-1$, we have that $load(c_0)=s_0$ and $load(c_j)=\frac{1+(k+1-j)(H_k - H_{k+1-i})}{k+1-j}=\frac{1}{k+1-j}+H_k-H_{k+1-i}$ for each $j\geq i$, so we add $c_i$ to the committee, which has $load(c_i)=H_k - H_{k-i}$, and update $load(n_j)\leftarrow H_k - H_{k_i}$ for each $j\geq i$. 
Finally, in the $k$-th round we have that $load(c_0)=1/s_0 = H_k - \eps$ and $load(c_k)=H_k$, thus we elect $c_0$ as the final committee member. This completes the proof.
\end{proof}

Next we analyze $\MMS$ (Algorithm~\ref{alg:mms}), an iterative heuristic that greedily inserts new candidates that maximize the maximin support objective. 
We show that in fact it achieves a constant-factor approximation guarantee, though with a considerably slower running time of $O(B\cdot |C|\cdot k)$, where we recall that $B$ is the complexity of computing a balanced weight vector; see the end of Section~\ref{s:prel}. 

\begin{algorithm}[htb]\label{alg:mms}
\SetAlgoLined
\KwData{Bipartite approval graph $G=(N\cup C, E)$, vector $s$ of vote strengths, target committee size $k$.}
Initialize $A=\emptyset$\ and $w=0\in \R^E$\;
\For{$i=1,2,\cdots k$}{
\For{each $c\in C\setminus A$}{
Compute a balanced\footnotemark ~edge weight vector $w_c$ for $A+c$\;
}
Find $c_i\in \arg\max_{c\in C\setminus A} supp_{w_c}(A+c)$\;
Set $A\leftarrow A+c_i$ and $w\leftarrow w_{c_i}$;
}
\Return $(A,w)$\;
\caption{$\MMS$, proposed in~\cite{sanchez2016maximin}}
\end{algorithm}
\footnotetext{The original algorithm in~\cite{sanchez2016maximin} does not compute balanced weight vectors, and indeed any feasible vector that maximizes $supp_w(A)$ is sufficient for our analysis. 
However, we propose the use of balanced vectors here as they achieve further desirable properties (Lemmas \ref{lem:balanced} and \ref{lem:maximin-support-eqiv}) and because adding such requirement does not seem to cause any additional overhead in complexity.}

\begin{theorem}\label{thm:mms}
The $\MMS$ algorithm provides a 2-approximation for maximin support.
\end{theorem}

The key to the proof is the following technical result, whose proof we delay momentarily.

\begin{lemma}\label{lem:2sols}
If $(A,w)$ and $(A^*, w^*)$ are two feasible solutions of an instance of maximin support with $|A|< |A^*|$, then there is a candidate $c\in A^*\setminus A$ and a feasible solution $(A+c, w')$ such that 

$$supp_{w'}(A+c)\geq \min\Big\{supp_w(A), \frac{1}{2} supp_{w^*}(A^*)\Big\}.$$
\end{lemma}


\begin{proof}[Proof of Theorem~\ref{thm:mms}]
Let $(A_i, w_i)$ be the partial solution at the end of the $i$-th round of MMS, and let $(A^*, w^*)$ be an optimal full solution. We prove by induction on $i$ that $supp_{w_i}(A_i)\geq \frac{1}{2}supp_{w^*}(A^*)$, where the base case for $i=0$ holds trivially as we use the convention that $supp_w(\emptyset)=\infty$.

Assuming that the inequality holds for $i$, an application of Lemma~\ref{lem:2sols} for $(A_i, w_i)$ and $(A^*, w^*)$ implies that there is a candidate $c\in A^*\setminus A_i$ and a feasible solution $(A_i+c, w')$ such that 

$$supp_{w'}(A_i+c)\geq \min\Big\{supp_{w_i}(A_i), \frac{1}{2} supp_{w^*}(A^*)\Big\} = \frac{1}{2} supp_{w^*}(A^*).$$

As the algorithm is bound to inspect candidate $c$ in round $i+1$, and compute for it a balanced weight vector $w_c$ which maximizes the support of $A_i+c$ (by Lemma~\ref{lem:balanced}), the solution $(A_{i+1}, w_{r+1})$ at the end of round $i+1$ must have an even higher support, i.e. %
%
$$supp_{w_{i+1}}(A_{i+1})\geq supp_{w_c}(A_i+c) 
\geq supp_{w'}(A_i+c) \geq \frac{1}{2} supp_{w^*}(A^*).$$
%
This completes the proof.
\end{proof}

\begin{proof}[Proof of Lemma~\ref{lem:2sols}]
Let $(A,w)$ and $(A^*, w^*)$ be as in the statement, let $t^*:=supp_{w^*}(A^*)$, and let $t:=\min\{supp_w(A), t^*/2\}$. To prove the lemma, it suffices to find a candidate $c\in A^*\setminus A$ and a feasible weight vector $w'\in\R^E$ such that $supp_{w'}(A+c)\geq t$.

By decreasing some components in $w$ and $w^*$, we can assume without loss of generality that $supp_w(c)=t$ for each $c\in A$, and $supp_{w^*}(c)=t^*$ for each $c\in A^*$. Define now vector $f:=w^* - w\in\mathbb{R}^E$, which we interpret as a vector of flows over the network induced by $N\cup A\cup A^*$, with positive signs corresponding to flow leaving $N$, and vice versa. We partition the network nodes into four sets: relative to $f$, we have that a) $N$ has a net excess of $|A^*|\cdot t^* - |A|\cdot t$, b) $A\setminus A^*$ has a net excess of $|A\setminus A^*|\cdot t$, c) $A^*\setminus A$ has a net demand of $|A^*\setminus A|\cdot t^*$, and d) $A\cap A^*$ has a net demand of $|A\cap A^*|\cdot (t^*-t)$.

Now, using the flow decomposition theorem, we can decompose flow $f$ into circulations and simple paths, where each path starts in one of the sets with net excess and ends in one of the sets with net demand. If we define $f'$ to be the sub-flow of $f$ that contains only the simple paths that start in $N$ and end in $A^*\setminus A$, then %
%
\begin{align*}
    \text{net demand in $A^*\setminus A$ w.r.t. } f' &\geq \text{ net demand in $A^*\setminus A$ w.r.t. } f - \text{ net excess in $A\setminus A^*$ w.r.t. } f\\
    &= |A^*\setminus A|\cdot t^* - |A\setminus A^*|\cdot t\\
    &\geq |A^*\setminus A|\cdot (t^*-t) \geq |A^*\setminus A|\cdot t,
\end{align*}

where the last two inequalities follow from $|A^*|\geq |A|$ and $t\leq t^*/2$, respectively. By an averaging argument, this implies that there is a candidate $c\in A^*\setminus A$ with a demand of at least $t$ relative to $f'$.

Finally, we define weight vector $w':=w+f'$. Since $f'$ is a sub-flow of $f=w^* - w$ (meaning that for every edge $e$, $f'_e$ is of equal sign and smaller absolute value than $f_e$), it follows that $w'$ is non-negative. Moreover, as the excess of any voter $n\in N$ relative to $f'$ is smaller than its excess relative to $f$, we have that 
$$\sum_{c\in C_n} {w'}_{nc}=\sum_{c\in C_n} (w_{nc} + f'_{nc}) \leq \sum_{c\in C_n} (w_{nc} + f_{nc})=\sum_{c\in C_n} w^*_{nc} \leq s_n,$$ 
and thus $w'$ is feasible. Furthermore, $w'$ provides the same support as $w$ to each committee member $c\in A$, and a support of at least $t$ to candidate $c$. Hence, $supp_{w'}(A+c)\geq t$, which is what we needed to show.
\end{proof}

To conclude the section we present $\lazy$, a variant of $\MMS$ that is considerably faster (by a factor $\tilde{\Omega}(k)$) and offers virtually the same approximation guarantee. 
This algorithm does not necessarily satisfy PJR, though this fact becomes irrelevant as in Section~\ref{s:local} we provide a post-computation which preserves that approximation guarantee and ensures PJR (see Theorem~\ref{thm:enabler}). The complexity of this post-computation is easily dominated by that of the algorithm.

\begin{theorem}\label{thm:2eps}
For any constant $\eps>0$, $\lazy$ (Algorithm~\ref{alg:lazy}) executes in time $O(B\cdot |C|\cdot \log(\eps^{-1} \log k))$ and offers a $(2+\eps)$-approximation for the maximin support problem.
\end{theorem}

Algorithm $\lazy$ is similar to $\MMS$ (Algorithm~\ref{alg:mms}), but is lazier in the sense that for each candidate that it explores, it decides on the spot whether to add it to the current partial solution, if the candidate is "good enough", or discard it. Hence, the algorithm performs a single pass over the candidate set, instead of $k$ passes. 
For a target support value $t\geq 0$ given as input, the algorithm either succeeds and returns a full solution $(A,w)$ with $supp_w(A)\geq t$, or it returns a failure message. 

\begin{algorithm}[htb]\label{alg:lazy}
\SetAlgoLined
\KwData{Approval graph $G=(N\cup C, E)$, vector $s$ of vote strengths, committee size $k$, target support $t\geq 0$.}
Initialize $A=\emptyset$\ and $w=0\in\R^E$\;
\For{each candidate $c\in C$ (over an arbitrary traversing order in $C$)}{
Compute a balanced edge weight vector $w_c$ for $A+c$\;
\If{$supp_{w_c}(A+c)\geq t$}{
Update $A\leftarrow A+c$ and $w\leftarrow w_c$\;
\lIf{$|A|=k$}
{
    \Return $(A,w)$
}
}
}
\Return a failure message\;
\caption{$\lazy$}
\end{algorithm}

\begin{lemma}\label{lem:success}
If $(A^*, w^*)$ is an optimal solution to the given instance of the maximin support problem, and $t^*=supp_{w^*}(A^*)$, then for any input target $t$ with $0\leq t\leq t^*/2$, Algorithm $\lazy$ is guaranteed to succeed.
\end{lemma}

\begin{proof}
Assume by contradiction that for some input target $t\leq t^*/2$, $\lazy$ fails. Thus, after traversing the whole candidate set $C$, the algorithm ends up with a partial solution $(A,w)$ with $|A|<k$ and $supp_w(A)\geq t$. By Lemma~\ref{lem:2sols}, there must be a candidate $c\in A^*\setminus A$ and a feasible solution $(A+c, w')$ such that $supp_{w'}(A+c)\geq t$. Notice as well that for any subset $S$ of $A+c$, vector $w'$ provides a support of at least $t$, so any balanced weight vector for $S$ also provides a support of at least $t$. This implies that at whichever point the algorithm inspected candidate $c$, it should have included it in the partial solution, which at that time was a subset of $A$. Hence, $c$ should be contained in $A$, and we reach a contradiction.
\end{proof}

The idea is then to run trials of $\lazy$ over several input values of target $t$, performing binary search to converge to a value where it flips from failure to success, and return the output of the last successful trial. Each trial clearly executes in time $O(B\cdot |C|)$. 
In the next lemma, whose proof is delayed to Appendix~\ref{s:proofs}, we establish the number of trials needed to achieve a solution whose value is within a factor $(2+\eps)$ from optimal for any $\eps>0$. This in turn proves Theorem~\ref{thm:2eps}.

\begin{lemma}\label{lem:lazybinary}
For any $\eps>0$, one can execute $O(\log(\eps^{-1}\log k))$ iterations of $\lazy$, where each iteration takes time $O(B\cdot |C|)$, to obtain a solution whose value is within a factor $(2+\eps)$ from optimal.
\end{lemma}
