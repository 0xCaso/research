
\section{Delayed proofs}\label{s:proofs}

\begin{proof}[Proof of Lemma~\ref{lem:balanced}]
The first statement is simply a special case of the second statement, for $r=1$. 
We temporarily skip the second statement and start by proving the third one, which we do by contradiction. 
We thus assume there is a voter $n\in N$ and two candidates $c\in C_n$, $c'\in C_n\cap A$, such that $w_{nc}>0$ and $supp_w(c) > supp_w(c')$. 
Let $\eps:=\min\{w_{nc}, (supp_w(c)-supp_w(c'))/2\}>0$, and define a new vector $w'\in\mathbb{R}^E$ where $w'_{nc}=w_{nc}-\eps$, $w'_{nc'}=w_{nc'}+\eps$, and $w'_e=w_e$ for every other edge $e\in E$. 
It can be checked that $w'$ is non-negative and feasible, and that it does not decrease the sum of member supports, i.e. $\sum_{d\in A} supp_{w'}(d)\geq \sum_{d\in A} supp_{w}(d)$, where the inequality is tight only if $c\in A$. We assume this to be the case, as otherwise the first condition on vector $w$ being balanced for $A$ is violated. On the other hand,
\begin{align*}
    \sum_{d\in A} supp_{w}^2(d) - \sum_{d\in A} supp_{w'}^2(d) &= supp_w^2(c) + supp_w^2(c) - supp_{w'}^2(c) - supp_{w'}^2(c') \\
    &= supp_w^2(c) + supp_w^2(c') - (supp_w(c)-\eps)^2 - (supp_w(c')+\eps)^2 \\
    &= 2\eps( supp_w(c) - supp_w(c')) -2\eps^2 \\
    &\geq 2\eps(2\eps) - 2\eps^2 = 2\eps^2 >0,
\end{align*}
which contradicts the second condition on vector $w$ being balanced for $A$.

We now prove the second statement, which says that function 
$F_{w'}^k:=\min_{A'\subseteq A, |A'|=r} \quad \sum_{c\in A'} supp_{w'}(c)$ 
is maximized by vector $w$ over all feasible vectors $w'\in\R^E$, for all $1\leq r\leq |A|$. 
Assume by contradiction that there is a threshold $r$ and feasible $w'$ such that $F_r^A(w')>F_r^A(w)$. We can also assume without loss of generality that 
\begin{enumerate}
    \item $\sum_{c\in A} supp_{w'}(c)=\sum_{c\in A} supp_{w}(c)$, i.e. $w'$ also satisfies the first condition of a balanced weight vector; and  
    \item we enumerate the candidates in $A=\{c_1, \cdots, c_{|A|}\}$ so that whenever $i<j$ we have that $supp_w(c_i)\leq supp_w(c_j)$, and in case of a tie, $supp_w(c_i)= supp_w(c_j)$, we have that $supp_{w'}(c_i)\leq supp_{w'}(c_j)$. 
\end{enumerate}

With a candidate enumeration as above, it follows that $F^A_r(w)=\sum_{i=1}^r supp_w(c_i)$, while for vector $w'$ we have the inequality $F^A_r(w')\leq \sum_{i=1}^r supp_{w'}(c_i)$. 
Thus, by our assumption by contradiction, 
$$\sum_{i=1}^r supp_{w'}(c_i) \geq F_r^A(w') > F_r^A(w) = \sum_{i=1}^r supp_{w}(c_i), \quad \text{and}$$
\begin{align*}
    \sum_{i=r+1}^{|A|} supp_{w'}(c_i) &= \sum_{i=1}^{|A|} supp_{w'}(c_i) - \sum_{i=1}^{r} supp_{w'}(c_i) \\
    & = \sum_{i=1}^{|A|} supp_{w}(c_i) - \sum_{i=1}^{r} supp_{w'}(c_i) \\
    & < \sum_{i=1}^{|A|} supp_{w}(c_i) - \sum_{i=1}^{r} supp_{w}(c_i) 
    = \sum_{i=r+1}^{|A|} supp_{w}(c_i). \\
\end{align*}
Now define the edge vector $f:=w'-w\in\mathbb{R}^E$ and consider it as a flow over the network $(N\cup A, E)$. 
We have that $f$ has a zero net demand over set $N$, by our first assumption, and the previous two inequalities show that $f$ has a positive net demand over set $\{c_1, \cdots, c_r\}$ and a positive net excess over set $\{c_{r+1}, \cdots, c_{|A|}\}$. Thus, by the flow decomposition theorem, $f$ can be decomposed into circulations and simple paths, where every path starts in a vertex with positive demand and ends in a vertex with positive excess, and there must be a simple path carrying some $\delta>0$ flow from $c_j$ to $c_i$ for some $1\leq i\leq r<j\leq |A|$. 
Moreover, by our second assumption, it must be the case that $supp_w(c_i)<supp_w(c_j)$, because in case of a tie we would have that $supp_{w'}(c_i)<supp_{w'}(c_j)$ and so $f$ would have a net excess on $c_i$ and net demand on $c_j$, and the $c_i$-to-$c_j$ path would not exist in the flow decomposition.

Let $f'$ be a sub-flow of $f$ that carries $\eps$ units of flow from $c_j$ to $c_i$, where $\eps:=\min\{\delta, \frac{1}{2}(supp_w(c_j) - supp_w(c_i))\}>0$. 
The fact that $f'$ is a sub-flow of $f$ implies that $w'':=w+f'$ is a feasible non-negative solution,%
\footnote{For a proof of feasibility and non-negativity, see the argument at the end of the proof in Lemma~\ref{lem:2sols}.} 
with 
\begin{align*}
    \sum_{c\in A} supp_{w}^2(c) - \sum_{c\in A} supp_{w''}^2(c) &= supp_{w}^2(c_i) + supp_w^2(c_j) - (supp_{w}(c_i) +\eps)^2 - (supp_{w}(c_j) - \eps)^2\\
    &= 2\eps(supp_w(c_j) - supp_w(c_i)) - 2\eps^2 \\
    &\geq 2\eps(2\eps) - 2\eps^2 = 2\eps^2>0,
\end{align*}
which contradicts the fact that $w$ minimizes the sum of supports squared. This completes the proof. 
\end{proof}



\begin{proof}[Proof of Lemma~\ref{lem:equivalence}]
Let $A'\subseteq A$ be the non-empty subset that minimizes the expression $\frac{1}{|A'|} \sum_{n\in \cup_{c\in A'} N_c} s_n$. Hence, 
\begin{align*}
    supp_w(A) &\leq supp_w(A') \leq \frac{1}{|A'|} \sum_{c\in A'} supp_w(c) &\text{(by an averaging argument)}\\
    & = \frac{1}{|A'|} \sum_{c\in A'} \sum_{n\in N_c} w_{nc} 
     \leq \frac{1}{|A'|}  \sum_{n\in \cup_{c\in A'} N_c} \quad \sum_{c\in C_n} w_{nc} \\
    & \leq \frac{1}{|A'|} \sum_{n\in \cup_{c\in A'} N_c} s_n &\text{(by \ref{eq:feasible})}.
\end{align*}

This proves one inequality. To prove the opposite inequality, we use the fact that $(A,w)$ is a balanced solution. 
Let $A_{\min}\subseteq A$ be the set of committee members with least support, i.e.~those $c\in A$ with $supp_w(c)=supp_w(A)$. Then,
\begin{align*}
    supp_w(A_{\min}) &= \frac{1}{|A_{\min}|} \sum_{c\in A_{\min}} supp_w(c) \\
    &= \frac{1}{|A_{\min}|} \sum_{c\in A_{\min}} \sum_{n\in N_c} w_{nc} 
    = \frac{1}{|A_{\min}|} \sum_{n\in \cup_{c\in A_{\min}} N_c} \quad \sum_{c\in C_n\cap A_{\min}} w_{nc} \\
    &= \frac{1}{|A_{\min}|} \sum_{n\in \cup_{c\in A_{\min}} N_c} \Big( \sum_{c\in C_n} w_{nc} - \sum_{c\in C_n \setminus A_{\min}} w_{nc}\Big).
\end{align*}

We now make two claims, one for each of the terms inside the parenthesis. 
The first claim is that $\sum_{c\in C_n} w_{nc}=s_n$, i.e. the feasibility inequality~\eqref{eq:feasible} must be tight, for each nominator $n$ in $\cup_{c\in A_{\min}} N_c$, 
or more generally each nominator in $\cup_{c\in A} N_c$, because balanced vector $w$ by definition maximizes the sum of supports over $A$. 
The second claim is that the second term is zero. Indeed, if there is a nominator $n$ in $\cup_{c\in A_{\min}} N_c$ and a candidate $c$ in $C_n\setminus A_{\min}$, then there must be at least one member $c'$ in $C_n\cap A'$, and the inequality $supp_w(c')<supp_w(c)$ must hold by definition of set $A_{\min}$; hence $w_{nc}=0$ by point 3 of Lemma~\ref{lem:balanced}. 
We obtain that 
$$supp_w(A_{\min}) = \frac{1}{|A_{\min}|}\sum_{n\in \cap_{c\in A_{\min}} N_c} s_n \geq \min_{\emptyset\neq A'\subseteq A} \frac{1}{|A'|}\sum_{n\in \cup_{c\in A'}N_c} s_n.$$
This proves the second inequality and completes the proof.
\end{proof}


\begin{proof}[Proof of Lemma~\ref{lem:subflow}]
We prove the claim only for $w+f'$, as the proof for $w'-f'$ is similar. 
For each edge $e\in E$, we have that $(w+f')_e$ is a value between $w_e$ and $(w+f)_e=w'_e$. As both of these values are non-negative, the same holds for $(w+f')_e$. 
Notice now from inequality \eqref{eq:feasible} that proving feasibility corresponds to proving that the excess $(w+f')(n)$ is at most $s_n$ for each voter $n\in N$. We have 
$$(w+f')(n) = \sum_{c\in C_n} (w+f')_{nc}= \sum_{c\in C_n} w_{nc} + \sum_{c\in C_n} f_{nc}' = w(n) + f'(n). $$
If excess $f'(n)$ is non-positive, then $(w+f')(n)\leq w(n) \leq s_n$, since $w$ is feasible. 
Otherwise, $f'(n)\leq f(n)$, and thus $(w+f')(n)\leq w(n) + f(n) = (w+f)(n) = w'(n) \leq s_n$, since $w'$ is feasible. This completes the proof.
\end{proof}

\begin{lemma}\label{lem:path}
Let $w\in \R^E$ be a feasible weight vector for a given instance, let $c,c'\in C$ be two candidates with $supp_w(c)>supp_w(c')$, and suppose there is a path $p\in\mathbb{R}^E$ that carries some non-zero flow from $c$ to $c'$, with zero excess elsewhere. If $w+p$ is non-negative and feasible, then $w$ is not balanced for any committee $A$ that contains $c'$.
\end{lemma}

\begin{proof}
Fix a committee $A\subseteq C$ that contains $c'$. If $c$ is not in $A$, then $w+p$ provides a greater sum of member supports over $A$ than $w$, so the latter is not balanced as it does not maximize this sum. Now suppose both $c$ and $c'$ are in $A$. Let $\lambda>0$ be the flow value carried by $p$, let $\eps:=\min\{\lambda, (supp_w(c) - supp_w(c'))/2\}>0$, and let $p'$ be the scalar multiple of $p$ whose flow value is $\eps$. By an application of Lemma~\ref{lem:subflow} over $w$ and $w':=w+p$, and the fact that $p'$ is a sub-flow of $p=w'-w$, we have that $w+p'$ is non-negative and feasible. Moreover, both $w$ and $w+p'$ clearly provide the same sum of member supports over $A$. Finally, if we compare their sums of member supports squared, we have that
\begin{align*}
\sum_{d\in A} supp_w^2(d)-\sum_{d\in A} supp^2_{w+p'}(d) &=supp_w^2(c) +supp_w^2(c')-supp^2_{w+p'}(c) -supp^2_{w+p'}(c')\\
&= supp_w^2(c) +supp_w^2(c') - (supp_w(c) - \eps)^2 - (supp_w(c) + \eps)^2 \\
&= 2\eps\cdot (supp_w(c) - supp_w(c') - \eps) \geq 2\eps\cdot(2\eps - \eps)=2\eps^2>0.
\end{align*}

Therefore, $w$ is not balanced for $A$, as it does not minimize the sum of member supports squared.  
\end{proof}

\begin{proof}[Proof of Lemma~\ref{lem:2balanced}]
The second statement follows directly from the first one and the definitions of slack, pre-score and score in Section~\ref{s:heuristic}. Hence we focus on the first statement, i.e.~that $supp_w(c)\geq supp_{w'}(c)$ for each candidate $c\in A$.

Consider vector $f:=w'-w\in\mathbb{R}^E$ as a flow vector over the network induced by $N\cup A'$. We need to prove that there is no candidate in $A$ with positive demand relative to $f$. Assume by contradiction that there is such a candidate $c'\in A$. By the flow decomposition theorem, $f$ can be decomposed into circulations and simple paths, where each path starts in a vertex with positive excess and ends in a vertex with positive demand. By our assumption, there must be a path $p$ carrying non-zero flow to $c'$.  
Now, where does path $p$ start? It cannot start in $N$ nor in $A'\setminus A$, as otherwise weight vector $w+p$ is feasible by Lemma~\ref{lem:subflow}, and has a greater sum of candidate supports over $A$ than $w$, which contradicts the fact that $w$ is balanced for $A$ and thus maximizes this sum. Therefore, it must start in another candidate $c$ in $A$ with positive excess. 
The fact that $f$ has positive excess in $c$ and positive demand in $c'$ implies that
$$supp_{w}(c') - supp_{w'}(c') = f(c')< 0 < f(c) = supp_{w}(c) - supp_{w'}(c),$$
which in turn implies that either $supp_w(c) > supp_w(c')$ or $supp_{w'}(c') > supp_{w'}(c)$, or both. 
If $supp_w(c) > supp_w(c')$, then Lemma~\ref{lem:path} implies that $w$ is not balanced for $A$. 
Similarly, if $supp_{w'}(c') > supp_{w'}(c)$, notice that $w'-p$ is non-negative and balanced by Lemma~\ref{lem:subflow}, so again Lemma~\ref{lem:path} applied over vector $w'$ and path $-p$ implies that $w'$ is not balanced for $A'$. Hence, in either case we reach a contradiction.
\end{proof}

\begin{proof}[Proof of Lemma~\ref{lem:Lebesgue}]
Recall that for any set $A\subseteq \mathbb{R}$, the indicator function $1_A:\mathbb{R}\rightarrow \mathbb{R}$ is defined as $1_A(t)=1$ if $t\in A$, and $0$ otherwise. For any $i\in I$, we can write
$$\alpha_i f(x_i) = \alpha_i \int_{0}^{f(x_i)} dt = \alpha_i\int_0^{\lim_{x\rightarrow \infty} f(x)} 1_{(-\infty, f(x_i)]}(t)dt,$$
and thus
\begin{align*}
    \sum_{i\in I} \alpha_i f(x_i) = \int_0^{\lim_{x\rightarrow \infty} f(x)} \Big(\sum_{i\in I} \alpha_i 1_{(-\infty, f(x_i)]}(t)\Big)dt = \int_0^{\lim_{x\rightarrow \infty} f(x)} \Big(\sum_{i\in I: \ f(x_i)\geq t} \alpha_i \Big)dt.
\end{align*}
This is a Lebesgue integral over the measure with weights $\alpha_i$. Now, conditions on function $f(x)$ are sufficient for its inverse $f^{-1}(t)$ to exist, with $f^{-1}(0)=\chi$. Substituting with the new variable $x=f^{-1}(t)$ on the formula above, where $t=f(x)$ and $dt=f'(x)dx$, we finally obtain
$$\sum_{i\in I} \alpha_i f(x_i) =\int_{\chi}^{\infty} \Big( \sum_{i\in I: \ x_i\geq x} \alpha_i \Big)(f'(x)dx).$$
\end{proof}

